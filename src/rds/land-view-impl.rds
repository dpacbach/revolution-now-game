# ===============================================================
# land-view-impl.rds
#
# Project: Revolution Now
#
# Created by dsicilia on 2020-11-13.
#
# Description: RDS definitions for the land-view module.
#
# ===============================================================
include [
  coord.hpp
  id.hpp
  physics.hpp

  # Rds
  rds/orders.hpp
]

namespace.rn {

sumtype.LandViewState {
  none {}
  unit_input {
    unit_id: UnitId
  }
  unit_move {
    unit_id: UnitId
  }
  unit_attack {
    attacker: UnitId
    defender: UnitId
    attacker_wins: bool
  }
}

sumtype.LandViewRawInput {
  orders {
    orders: orders_t
  }
  tile_click {
    coord: Coord
  }
  center {} # Center on blinking unit, if any.
}

# These are animation primitives. A unit "move" is a slide, and a
# unit attack sequence is constructed from a slide + depixela-
# tion.
sumtype.UnitAnimation {
  blink {
    visible: bool
  }
  slide {
    target: Coord
    percent: double
    percent_vel: DissipativeVelocity
  }
  depixelate {
    tx_depixelate_from: Texture
    pixels: 'std::vector<Coord>'
    demoted_pixels: 'Matrix<Color>'
  }
}

} # namespace rn
