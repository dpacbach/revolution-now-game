# ===============================================================
# testing.rnl
#
# Project: Revolution Now
#
# Created by dsicilia on 2020-11-02.
#
# Description: RNL definitions for unit testing.
#
# ===============================================================

# Revolution Now
include "maybe.hpp";

# C++ standard library
include <string>;
include <vector>;

# This is included because MyVariant2 is serializable.
include "fb/testing_generated.h";

namespace rnltest;

# Descriptive comment.
sumtype Maybe<T> {
  nothing:
  just:
    T val;
};

sumtype MyVariant0 {};

# Descriptive comment.
sumtype MyVariant1 {
  happy:
    std::pair<char,int> p;
  sad:
    bool hello;
    bool* ptr;
  excited:

  .features: equality;
};

sumtype MyVariant2 {
  first:
    std::string name;
    bool b;
  second:
    bool flag1;
    bool flag2;
  third:
    int cost;

  .features:
    formattable,
    serializable;
};

namespace rnltest.inner  ;

sumtype MyVariant3 {
  a1:
    MyVariant0_t var0;
  a2:
    MyVariant0_t var1;
    MyVariant2_t var2;
  a3:
    char c;
};

# Descriptive comment.
sumtype MyVariant4 {
  # List of features.
  # Alternatives.
  first:
    int i;
    char c;
    bool b;
    rn::maybe<uint32_t> op;
  _2nd:
  third:
    std::string s;
    MyVariant3_t var3;
};

# Descriptive comment.
sumtype TemplateTwoParams<T, U> {
  # List of features.
  # Alternatives.
  first_alternative:
    T t;
    char c;
  second_alternative:
  third_alternative:
    Maybe_t<T> hello;
    U u;
};

# This one has two template parameters are references another
# sumtype that also has two parameters.
sumtype CompositeTemplateTwo<T, U> {
  first:
    rnltest::inner::TemplateTwoParams_t<T,U> ttp;
  second:
};

namespace rn;

sumtype MySumtype {
  none:
  some:
    std::string s;
    int y;
  more:
    double d;

  .features:
    equality,
    formattable,
    serializable;
};

sumtype OnOffState {
  off:
  on:
    std::string user;
  switching_on:
    double percent;
  switching_off:
    double percent;

  .features:
    equality,
    formattable,
    serializable;
};

sumtype OnOffEvent {
  turn_off:
  turn_on:
};

enum e_empty {};

enum e_single {
  hello
};

enum e_two {
  hello,
  world
};

enum e_color {
  red,
  green,
  blue
};